---
id: 6092317
title: "ç”¨æˆ·åˆ†å±‚-å¦‚ä½•ä½¿ç”¨SQLè®¡ç®—RFMæ¨¡å‹"
tags: ["RFMæ¨¡å‹", "ç”¨æˆ·åˆ†å±‚", "ç»éªŒåˆ†äº«"]
custom_edit_url: https://www.woshipm.com/data-analysis/6092317.html
---
import { ArticleInfo } from '@site/src/components/ArticleInfo';

<ArticleInfo
    author="ææ˜‚"
    authorLink="https://www.woshipm.com/u/217107"
    published="2024-12-05"
    views={3566}
    comments={1}
    collects={38}
/>

> åœ¨äº§å“è¿è¥ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸éœ€è¦å°†ç”¨æˆ·è¿›è¡Œåˆ†å±‚ï¼Œä»¥ä¾¿æ›´å¥½é’ˆå¯¹æ€§åšè¿è¥ç­–ç•¥ã€‚æœ¬æ–‡åˆ†äº«äº†å¦‚ä½•ç”¨SQLç»“åˆRFMæ¨¡å‹ï¼Œå¯¹ç”¨æˆ·è¿›è¡Œåˆ†å±‚çš„æ–¹æ³•ï¼Œä¾›å¤§å®¶å‚è€ƒå­¦ä¹ ã€‚

---

## ç”¨æˆ·åˆ†å±‚-å¦‚ä½•ä½¿ç”¨SQLè®¡ç®—RFMæ¨¡å‹

[![](https://image.woshipm.com/wp-files/2018/09/84cwu5DU1YBztxeibDoD.jpg!/both/72x72)](https://www.woshipm.com/u/217107)

[ææ˜‚](https://www.woshipm.com/u/217107) ![](https://static.woshipm.com/tag/1101_1@2x.png)![](https://static.woshipm.com/tag/1301_1@2x.png) å…³æ³¨

2024-12-05

1 è¯„è®º 3566 æµè§ˆ 38 æ”¶è— 13 åˆ†é’Ÿ

[ğŸ”— äº§å“ç»ç†åœ¨ä¸åŒçš„èŒä¸šé˜¶æ®µï¼Œéœ€è¦ä¾§é‡ä¸åŒçš„æ–¹é¢ï¼Œä»åŸºç¡€æŠ€èƒ½ã€ä¸šåŠ¡æ·±åº¦ã€ä¸“ä¸šé¢†åŸŸåˆ°æˆ˜ç•¥è§„åˆ’å’Œç®¡ç†èƒ½åŠ›ã€‚](https://ke.qidianla.com/courses/90pm)

> åœ¨äº§å“è¿è¥ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸éœ€è¦å°†ç”¨æˆ·è¿›è¡Œåˆ†å±‚ï¼Œä»¥ä¾¿æ›´å¥½é’ˆå¯¹æ€§åšè¿è¥ç­–ç•¥ã€‚æœ¬æ–‡åˆ†äº«äº†å¦‚ä½•ç”¨SQLç»“åˆRFMæ¨¡å‹ï¼Œå¯¹ç”¨æˆ·è¿›è¡Œåˆ†å±‚çš„æ–¹æ³•ï¼Œä¾›å¤§å®¶å‚è€ƒå­¦ä¹ ã€‚

![](https://image.woshipm.com/2023/04/13/a66ce374-d9ee-11ed-bd74-00163e0b5ff3.jpg)

RFMæ¨¡å‹é€šå¸¸ç”¨äºåˆ†æç”¨æˆ·æ•°æ®åº“ï¼Œä»¥è¯†åˆ«æœ€æœ‰ä»·å€¼çš„ç”¨æˆ·ã€‚

**Recency (R)**â€“ ç”¨æˆ·æœ€åä¸€æ¬¡è´­ä¹°çš„æ—¶é—´ã€‚è·ç¦»ç°åœ¨æ—¶é—´è¶ŠçŸ­ï¼Œç”¨æˆ·å†æ¬¡è´­ä¹°çš„å¯èƒ½æ€§è¶Šå¤§ã€‚**Frequency (F)**\-ç”¨æˆ·åœ¨ä¸€å®šæ—¶é—´å†…è´­ä¹°çš„æ¬¡æ•°ã€‚é¢‘ç‡è¶Šé«˜ï¼Œè¡¨æ˜ç”¨æˆ·å¯¹å“ç‰Œçš„å¿ è¯šåº¦è¶Šé«˜ã€‚**Monetary (M)**\-ç”¨æˆ·åœ¨ä¸€å®šæ—¶é—´å†…ä¸ºå…¬å¸å¸¦æ¥çš„æ€»æ”¶ç›Šã€‚é‡‘é¢è¶Šé«˜ï¼Œè¡¨æ˜ç”¨æˆ·çš„ä»·å€¼è¶Šå¤§ã€‚

![](https://image.woshipm.com/2024/12/04/164ee6bc-b1ff-11ef-9cc7-00163e0b5ff3.png)

é€šè¿‡RFMæ¨¡å‹ï¼Œä¼ä¸šå¯ä»¥å¯¹ç”¨æˆ·è¿›è¡Œç»†åˆ†ï¼Œæ¯”å¦‚å°†ç”¨æˆ·åˆ†ä¸ºé«˜ä»·å€¼ç”¨æˆ·ã€éœ€è¦æŒ½ç•™çš„ç”¨æˆ·ã€æœ‰æ½œåŠ›çš„ç”¨æˆ·ç­‰ï¼Œç„¶åæ ¹æ®è¿™äº›ç»†åˆ†é‡‡å–ä¸åŒçš„è¥é”€ç­–ç•¥ã€‚

![](https://image.woshipm.com/2024/08/01/fe808f10-4ff5-11ef-b783-00163e0b5ff3.png)

ä½œä¸ºäº§å“ç»ç†å¦‚ä½•ä½¿ç”¨SQLè®¡ç®—RFMæ¨¡å‹ï¼Œå¯¹ç”¨æˆ·è¿›è¡Œåˆ†å±‚å‘¢ï¼Ÿ

## ä¸€ã€æ•°æ®æºå‡†å¤‡

![](https://image.woshipm.com/2024/08/01/104b76aa-4ff7-11ef-84b5-00163e0b5ff3.png)

ç”¨æˆ·ä¼šå‘˜è¡¨æ•°æ®

![](https://image.woshipm.com/2024/08/01/7f6ae8a4-4ff7-11ef-ab7e-00163e0b5ff3.png)

è®¢å•è¡¨æ•°æ®(éƒ¨åˆ†å­—æ®µ)

å›  MySQL æ€§èƒ½é—®é¢˜ï¼Œæˆ‘ä»¬å°†æ•°æ®é€šè¿‡Binlogè®¢é˜…åŒæ­¥åˆ° Hive è¿›è¡Œè®¡ç®—ï¼›

![](https://image.woshipm.com/2024/08/01/cc6151b6-4ff7-11ef-a653-00163e0b5ff3.png)

## è€Œã€æ•°æ®è®¡ç®—

### 2.1ã€RFMæ¨¡å‹çš„è®¡ç®—æ­¥éª¤å¦‚ä¸‹ï¼š

**ç¡®å®šæ—¶é—´èŒƒå›´**ï¼šé¦–å…ˆç¡®å®šåˆ†æçš„æ—¶é—´èŒƒå›´ï¼Œæ¯”å¦‚è¿‡å»ä¸€å¹´æˆ–è¿‡å»å…­ä¸ªæœˆã€‚

[![](https://image.woshipm.com/2023/08/02/bf59b8ba-30e4-11ee-88e7-00163e0b5ff3.png)

åšäº†8å¹´äº§å“ç»ç†åï¼Œæˆ‘æ˜¯è¿™ä¹ˆçœ‹äº§å“ç»ç†çš„

æˆ‘ä¸ªäººæ˜¯ä»éå¸¸åˆçº§çš„äº§å“ç»ç†åšèµ·ï¼Œå†åˆ°è´Ÿè´£ä¸€ä¸ªå¤§äº§å“çš„é¡¹ç›®ç®¡ç†ï¼Œç°åœ¨æœ‰å¹¸è·³å‡ºäº†æ—¥å¸¸åŸºç¡€çš„å·¥ä½œæ›´å¤šçš„å»çœ‹äº§å“çš„PMFï¼Œproduct strategy...

æŸ¥çœ‹è¯¦æƒ… >

](https://ke.qidianla.com/courses/bcpm)

è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨

> AND TO\_DATE(o.SOCreateTime) >= â€˜2024-04-01â€²  
> AND TO\_DATE(o.SOCreateTime) <=â€™2024-06-30â€™

**æ”¶é›†æ•°æ®**ï¼šæ”¶é›†å®¢æˆ·åœ¨æ‰€é€‰æ—¶é—´èŒƒå›´å†…çš„æ‰€æœ‰äº¤æ˜“è®°å½•ã€‚

> SELECT m.mimemberid AS memberid,  
> MAX(o.socreatetime) AS last\_order\_time,  
> DATEDIFF(â€˜2024-07-01â€™, MAX(o.socreatetime)) AS R,  
> COUNT(o.soordersn) AS F,  
> SUM(o.sototalamount) AS M  
> FROM ods\_travel.v\_teschoolinnermarket\_memberinfo m  
> LEFT JOIN paimon.fts\_base\_tetravelrvsorder.schoolorder o  
> ON m.mimemberid = o.somemberid  
> WHERE o.SOPayStatus = 2  
> AND m.MIStatus = 0  
> AND TO\_DATE(o.SOCreateTime) >= â€˜2024-04-01â€™  
> AND TO\_DATE(o.SOCreateTime) <= â€˜2024-06-30â€™  
> GROUP BY m.mimemberid  
> ORDER BY R ASC;

**è®¡ç®—Recency (R)**ï¼š

*   å¯¹äºæ¯ä¸ªå®¢æˆ·ï¼Œæ‰¾å‡ºæœ€åä¸€æ¬¡è´­ä¹°çš„æ—¥æœŸã€‚
*   è®¡ç®—ä»æœ€åä¸€æ¬¡è´­ä¹°åˆ°å½“å‰æ—¥æœŸçš„å¤©æ•°æˆ–æœˆæ•°ã€‚

**è®¡ç®—Frequency (F)**ï¼š

*   å¯¹äºæ¯ä¸ªå®¢æˆ·ï¼Œè®¡ç®—åœ¨æ‰€é€‰æ—¶é—´èŒƒå›´å†…çš„è´­ä¹°æ¬¡æ•°ã€‚

**è®¡ç®—Monetary (M)**ï¼š

*   å¯¹äºæ¯ä¸ªå®¢æˆ·ï¼Œè®¡ç®—åœ¨æ‰€é€‰æ—¶é—´èŒƒå›´å†…çš„æ€»è´­ä¹°é‡‘é¢ã€‚

> DROP TABLE IF EXISTS adsxyt\_travel.userrfm;  
> CREATE TABLE adsxyt\_travel.userrfm  
> STORED AS ORC AS  
> WITH mada\_order\_num AS (  
> SELECT a.SOMemberId AS memberid, COUNT(\*) AS ordernum  
> FROM paimon.fts\_base\_tetravelrvsorder.SchoolOrder a  
> INNER JOIN paimon.fts\_base\_tetravelrvsorder.SchoolOrderExpand b ON a.SOOrderSn = b.SOEOrderSn  
> WHERE a.SOPayStatus = 2  
> AND TO\_DATE(a.SOCreateTime) >= â€˜2024-04-01â€™  
> AND TO\_DATE(a.SOCreateTime) <= â€˜2024-06-30â€™  
> GROUP BY a.SOMemberId  
> ),  
> base\_data AS (  
> â€” æŸ¥è¯¢æœ€åŸå§‹çš„RFMå€¼  
> SELECT m.mimemberid AS memberid, MAX(o.socreatetime) AS last\_order\_time  
> , DATEDIFF(â€˜2024-07-01â€™, MAX(o.socreatetime)) AS R  
> , COUNT(o.soordersn) AS F, SUM(o.sototalamount) AS M  
> FROM ods\_travel.v\_teschoolinnermarket\_memberinfo m  
> LEFT JOIN paimon.fts\_base\_tetravelrvsorder.schoolorder o ON m.mimemberid = o.somemberid  
> WHERE o.SOPayStatus = 2  
> AND m.MIStatus = 0  
> AND TO\_DATE(o.SOCreateTime) >= â€˜2024-04-01â€™  
> AND TO\_DATE(o.SOCreateTime) <= â€˜2024-06-30â€™  
> GROUP BY m.mimemberid  
> ),  
> quartiles AS (  
> â€” æŒ‰ç…§æ•°æ®çš„4åˆ†ä½æ•°è®¡ç®—RFMå¾—åˆ†  
> SELECT \*, NTILE(4) OVER (ORDER BY R) AS R\_score  
> , NTILE(4) OVER (ORDER BY F DESC) AS F\_score  
> , NTILE(4) OVER (ORDER BY M DESC) AS M\_score  
> FROM base\_data  
> ),  
> quartiles\_fixed AS (  
> â€” å››åˆ†ä½æ•°ä¿®æ­£  
> SELECT \*  
> , CASE  
> WHEN R\_score = 1 THEN 4  
> WHEN R\_score = 2 THEN 3  
> WHEN R\_score = 3 THEN 2  
> ELSE 1  
> END AS R\_score\_fixed  
> , CASE  
> WHEN F\_score = 1 THEN 1  
> WHEN F\_score = 2 THEN 2  
> WHEN F\_score = 3 THEN 3  
> ELSE 4  
> END AS F\_score\_fixed  
> , CASE  
> WHEN M\_score = 1 THEN 1  
> WHEN M\_score = 2 THEN 2  
> WHEN M\_score = 3 THEN 3  
> ELSE 4  
> END AS M\_score\_fixed  
> FROM quartiles  
> ),  
> means AS (  
> SELECT AVG(R\_score\_fixed) AS r\_mean, AVG(F\_score\_fixed) AS f\_mean  
> , AVG(M\_score\_fixed) AS m\_mean  
> FROM quartiles\_fixed  
> )  
> SELECT qf.memberid, mc.ordernum, qf.last\_order\_time, qf.R, qf.F  
> , qf.M, qf.R\_score\_fixed AS R\_score, qf.F\_score\_fixed AS F\_score, qf.M\_score\_fixed AS M\_score, m.r\_mean  
> , m.f\_mean, m.m\_mean  
> , CASE  
> WHEN R\_score\_fixed > m.r\_mean THEN â€˜é«˜â€™  
> ELSE â€˜ä½â€™  
> END AS R\_label  
> , CASE  
> WHEN F\_score\_fixed > m.f\_mean THEN â€˜é«˜â€™  
> ELSE â€˜ä½â€™  
> END AS F\_label  
> , CASE  
> WHEN M\_score\_fixed > m.m\_mean THEN â€˜é«˜â€™  
> ELSE â€˜ä½â€™  
> END AS M\_label  
> FROM quartiles\_fixed qf  
> CROSS JOIN means m  
> LEFT JOIN order\_num mc ON qf.memberid = mc.memberid  
> ORDER BY qf.R ASC;

é€šè¿‡ä¸€ç³»åˆ—å…¬å…±è¡¨è¡¨è¾¾å¼ï¼ˆCTEsï¼‰æ„å»ºäº†ä¸€ä¸ªRFMï¼ˆæœ€è¿‘è´­ä¹°è¡Œä¸ºã€è´­ä¹°é¢‘ç‡ã€è´­ä¹°é‡‘é¢ï¼‰åˆ†ææ¨¡å‹ï¼Œç”¨äºå¯¹ä¼šå‘˜è¿›è¡Œåˆ†ç±»ã€‚é¦–å…ˆï¼Œå®ƒè®¡ç®—äº†æ¯ä¸ªä¼šå‘˜åœ¨æŒ‡å®šæ—¶é—´æ®µå†…çš„è®¢å•æ•°é‡ã€æœ€åä¸‹å•æ—¶é—´ã€ä»¥åŠåŸºäºè¿™äº›æ•°æ®çš„RFMåŸå§‹å€¼ã€‚æ¥ç€ï¼Œé€šè¿‡å››åˆ†ä½æ•°æ–¹æ³•ä¸ºæ¯ä¸ªRFMå€¼åˆ†é…å¾—åˆ†ï¼Œå¹¶è¿›è¡Œä¿®æ­£ä»¥ç¡®ä¿å¾—åˆ†ä¸ä¼šå‘˜ä»·å€¼æ­£ç›¸å…³ã€‚ç„¶åï¼Œè®¡ç®—è¿™äº›å¾—åˆ†çš„å¹³å‡å€¼ï¼Œç”¨äºç¡®å®šæ¯ä¸ªä¼šå‘˜çš„RFMæ ‡ç­¾ï¼ˆé«˜æˆ–ä½ï¼‰ã€‚æœ€åï¼Œç»“åˆè¿™äº›æ ‡ç­¾å’Œè®¢å•æ•°é‡ï¼Œå¯¹ä¼šå‘˜è¿›è¡Œåˆ†ç±»ï¼Œå¹¶æŒ‰æœ€è¿‘è´­ä¹°è¡Œä¸ºè¿›è¡Œæ’åºã€‚

**ä¸ºRFMæ‰“åˆ†**ï¼š

*   å°†Rã€Fã€Mçš„å€¼åˆ†åˆ«è¿›è¡Œæ ‡å‡†åŒ–æˆ–å½’ä¸€åŒ–ï¼Œä»¥ä¾¿äºæ¯”è¾ƒã€‚ä¾‹å¦‚ï¼Œå¯ä»¥ä½¿ç”¨æ’åæˆ–ç™¾åˆ†æ¯”æ¥ä¸ºæ¯ä¸ªç»´åº¦æ‰“åˆ†ã€‚
*   Recencyå¯ä»¥æŒ‰ç…§æ—¶é—´ä»è¿‘åˆ°è¿œè¿›è¡Œæ’åºï¼Œç„¶ååˆ†é…åˆ†æ•°ï¼Œæ—¶é—´è¶Šè¿‘åˆ†æ•°è¶Šé«˜ã€‚
*   Frequencyå¯ä»¥æŒ‰ç…§è´­ä¹°æ¬¡æ•°ä»å¤šåˆ°å°‘è¿›è¡Œæ’åºï¼Œç„¶ååˆ†é…åˆ†æ•°ï¼Œè´­ä¹°æ¬¡æ•°è¶Šå¤šåˆ†æ•°è¶Šé«˜ã€‚
*   Monetaryå¯ä»¥æŒ‰ç…§æ€»é‡‘é¢ä»é«˜åˆ°ä½è¿›è¡Œæ’åºï¼Œç„¶ååˆ†é…åˆ†æ•°ï¼Œé‡‘é¢è¶Šé«˜åˆ†æ•°è¶Šé«˜ã€‚

**ç»¼åˆRFMå¾—åˆ†**ï¼š

*   å°†Rã€Fã€Mçš„åˆ†æ•°ç›¸åŠ ï¼Œå¾—åˆ°æ¯ä¸ªå®¢æˆ·çš„RFMæ€»åˆ†ã€‚
*   æ ¹æ®æ€»åˆ†å°†å®¢æˆ·åˆ†ä¸ºä¸åŒçš„ç¾¤ä½“ï¼Œå¦‚é«˜ä»·å€¼å®¢æˆ·ã€éœ€è¦æŒ½ç•™çš„å®¢æˆ·ã€ä½ä»·å€¼å®¢æˆ·ç­‰ã€‚

**åˆ†æå’Œåº”ç”¨**ï¼š

*   åˆ†æä¸åŒRFMç¾¤ä½“çš„ç‰¹å¾ï¼Œåˆ¶å®šç›¸åº”çš„è¥é”€ç­–ç•¥ã€‚
*   ä¾‹å¦‚ï¼Œå¯¹äºé«˜RFMå¾—åˆ†çš„å®¢æˆ·ï¼Œå¯ä»¥æä¾›å¿ è¯šåº¦å¥–åŠ±æˆ–ä¸ªæ€§åŒ–æœåŠ¡ï¼›å¯¹äºä½RFMå¾—åˆ†çš„å®¢æˆ·ï¼Œå¯ä»¥è®¾è®¡ä¿ƒé”€æ´»åŠ¨ä»¥æé«˜å…¶è´­ä¹°é¢‘ç‡å’Œé‡‘é¢ã€‚

**å››ç­‰ä½æ•°æ³•**

å…¶ä¸­ä½¿ç”¨äº†å››åˆ†ä½æ•°ï¼Œæ˜¯ç»Ÿè®¡å­¦åˆ†ä½æ•°ä¸­çš„ä¸€ç§ï¼ŒæŠŠæ‰€æœ‰æ•°å€¼ä»ä½åˆ°é«˜ï¼ˆæˆ–è€…ä»é«˜åˆ°åº•ï¼‰æ’åˆ—å¹¶åˆ†æˆå››ç­‰ä»½ï¼Œå¤„äºä¸‰ä¸ªåˆ†å‰²ç‚¹ä½ç½®çš„æ•°å€¼å°±æ˜¯å››åˆ†ä½æ•°ã€‚  
ä¸€èˆ¬è¡¨ç¤ºä¸ºï¼š  
Q1ï¼šæ ·æœ¬æ’åˆ—ä¸­å¤„äº25%ä½ç½®çš„æ•°å­—ï¼›  
Q2ï¼šåˆç§°ä¸ºä¸­ä½æ•°ï¼ŒæŒ‡çš„æ˜¯æ ·æœ¬æ’åˆ—ä¸­å¤„äº50%ä½ç½®ï¼Œå³ä¸­é—´ä½ç½®çš„æ•°æ®ï¼›  
Q3ï¼šæ ·æœ¬æ’åˆ—ä¸­å¤„äº75%ä½ç½®çš„æ•°å­—ã€‚

å‡è®¾æ ·æœ¬æ•°æ®é¡¹æ•°ä¸€å…±æ˜¯Nï¼š  
åˆ™Q1çš„ä½ç½®æ•°å€¼=ï¼ˆN+1ï¼‰/4ï¼›  
Q2çš„ä½ç½®æ•°å€¼=ï¼ˆN+1)/2ï¼›  
Q3çš„ä½ç½®æ•°å€¼=3ï¼ˆN+1)/4ã€‚  
å¦‚æœï¼ˆN+1ï¼‰æ°å¥½æ˜¯4çš„å€æ•°ï¼Œåˆ™ç¡®å®šå››åˆ†ä½æ•°æ¯”è¾ƒç®€å•ï¼Œå¦‚æœä¸æ˜¯4çš„å€æ•°ï¼Œç›¸å…³ä½ç½®çš„å››åˆ†ä½æ•°å°±åº”è¯¥æ˜¯ç›¸é‚»ä¸¤ä¸ªæ•°å€¼çš„æ ‡å¿—å€¼çš„å¹³å‡æ•°ã€‚æƒæ•°çš„å¤§å°å–å†³äºä¸¤ä¸ªæ•°å€¼è·ç¦»çš„è¿œè¿‘ï¼Œè·ç¦»è¶Šè¿‘æƒæ•°è¶Šå¤§ï¼Œè·ç¦»è¶Šè¿œï¼Œæƒæ•°è¶Šå°ï¼Œæƒæ•°ä¹‹å’Œç­‰äº1ã€‚

> DROP TABLE IF EXISTS adsxyt\_travel.userrfmcategory;  
> CREATE TABLE adsxyt\_travel.userrfmcategory  
> STORED AS ORC AS  
> SELECT memberid, mada\_ordernum, last\_order\_time, R, F, M  
> , R\_score, F\_score, M\_score, r\_mean, f\_mean  
> , m\_mean, R\_label, F\_label, M\_label  
> , CASE  
> WHEN R\_label = â€˜é«˜â€™  
> AND F\_label = â€˜é«˜â€™  
> AND M\_label = â€˜é«˜â€™  
> THEN â€˜é‡è¦ä»·å€¼ç”¨æˆ·â€™  
> WHEN R\_label = â€˜é«˜â€™  
> AND F\_label = â€˜ä½â€™  
> AND M\_label = â€˜é«˜â€™  
> THEN â€˜é‡è¦å‘å±•ç”¨æˆ·â€™  
> WHEN R\_label = â€˜ä½â€™  
> AND F\_label = â€˜é«˜â€™  
> AND M\_label = â€˜é«˜â€™  
> THEN â€˜é‡è¦ä¿æŒç”¨æˆ·â€™  
> WHEN R\_label = â€˜ä½â€™  
> AND F\_label = â€˜ä½â€™  
> AND M\_label = â€˜é«˜â€™  
> THEN â€˜é‡è¦æŒ½ç•™ç”¨æˆ·â€™  
> WHEN R\_label = â€˜é«˜â€™  
> AND F\_label = â€˜é«˜â€™  
> AND M\_label = â€˜ä½â€™  
> THEN â€˜ä¸€èˆ¬ä»·å€¼ç”¨æˆ·â€™  
> WHEN R\_label = â€˜é«˜â€™  
> AND F\_label = â€˜ä½â€™  
> AND M\_label = â€˜ä½â€™  
> THEN â€˜ä¸€èˆ¬å‘å±•ç”¨æˆ·â€™  
> WHEN R\_label = â€˜ä½â€™  
> AND F\_label = â€˜é«˜â€™  
> AND M\_label = â€˜ä½â€™  
> THEN â€˜ä¸€èˆ¬ä¿æŒç”¨æˆ·â€™  
> WHEN R\_label = â€˜ä½â€™  
> AND F\_label = â€˜ä½â€™  
> AND M\_label = â€˜ä½â€™  
> THEN â€˜ä¸€èˆ¬æŒ½ç•™ç”¨æˆ·â€™  
> ELSE â€˜æœªåˆ†ç±»â€™  
> END AS user\_category  
> FROM adsxyt\_travel.userrfm;

*   ä½¿ç”¨CASEè¯­å¥æ ¹æ®Rã€Fã€Mçš„æ ‡ç­¾å€¼ï¼ˆâ€™é«˜â€™æˆ–â€™ä½â€™ï¼‰æ¥ç¡®å®šç”¨æˆ·ç±»åˆ«ã€‚è¿™äº›æ ‡ç­¾å¯èƒ½ä»£è¡¨äº†ç”¨æˆ·åœ¨æœ€è¿‘æ€§ï¼ˆRecencyï¼‰ã€é¢‘ç‡ï¼ˆFrequencyï¼‰ã€è´§å¸ä»·å€¼ï¼ˆMonetaryï¼‰ä¸‰ä¸ªæ–¹é¢çš„è¡¨ç°ã€‚
*   user\_categoryæ˜¯æ ¹æ®Rã€Fã€Mçš„æ ‡ç­¾å€¼ç»„åˆæ¥å®šä¹‰çš„ç”¨æˆ·ç±»åˆ«ï¼Œå¦‚â€œé‡è¦ä»·å€¼ç”¨æˆ·â€ã€â€œé‡è¦å‘å±•ç”¨æˆ·â€ç­‰ã€‚ï¼ˆå‚ç…§ä¸Šè¿°è¡¨æ ¼ï¼‰

## ä¸‰ã€æ•°æ®ç»“æœ

æ•æ„Ÿæ•°æ®ä¸åšæš‚æ—¶ï¼Œæœ¬æ–‡æä¾› SQL è®¡ç®—è§£å†³æ€è·¯ï¼Œå…·ä½“å¯å‚ç…§å®éªŒã€‚

æœ¬æ–‡ç”± @ææ˜‚ åŸåˆ›å‘å¸ƒäºäººäººéƒ½æ˜¯äº§å“ç»ç†ã€‚æœªç»ä½œè€…è®¸å¯ï¼Œç¦æ­¢è½¬è½½

é¢˜å›¾æ¥è‡ªUnsplashï¼ŒåŸºäºCC0åè®®

è¯¥æ–‡è§‚ç‚¹ä»…ä»£è¡¨ä½œè€…æœ¬äººï¼Œäººäººéƒ½æ˜¯äº§å“ç»ç†å¹³å°ä»…æä¾›ä¿¡æ¯å­˜å‚¨ç©ºé—´æœåŠ¡

èµèµ æ”¶è—å·²æ”¶è—38 ç‚¹èµå·²èµ9

æ›´å¤šç²¾å½©å†…å®¹ï¼Œè¯·å…³æ³¨äººäººéƒ½æ˜¯äº§å“ç»ç†å¾®ä¿¡å…¬ä¼—å·æˆ–ä¸‹è½½App

[RFMæ¨¡å‹](https://www.woshipm.com/tag/rfm%e6%a8%a1%e5%9e%8b)[ç”¨æˆ·åˆ†å±‚](https://www.woshipm.com/tag/%e7%94%a8%e6%88%b7%e5%88%86%e5%b1%82)[ç»éªŒåˆ†äº«](https://www.woshipm.com/tag/%e7%bb%8f%e9%aa%8c%e5%88%86%e4%ba%ab)

[åˆ†äº«åˆ°å¾®åš](https://service.weibo.com/share/share.php?appkey=2775287854&title=ç”¨æˆ·åˆ†å±‚-å¦‚ä½•ä½¿ç”¨SQLè®¡ç®—RFMæ¨¡å‹&url=https://www.woshipm.com/data-analysis/6092317.html&pic=https://image.woshipm.com/2023/04/13/a66ce374-d9ee-11ed-bd74-00163e0b5ff3.jpg)

å¾®ä¿¡æ‰«ä¸€æ‰«

![å¾®ä¿¡äºŒç»´ç ](https://api.pwmqr.com/qrcode/create/?url=https://www.woshipm.com/data-analysis/6092317.html)

åˆ†äº«